@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication

@inject NavigationManager Navigation
@inject SignOutSessionStateManager SignOutManager

<div class="navbar-nav px-3">
    <div class="nav-item text-nowrap">
        <AuthorizeView>
            <Authorized>
                <Dropdown>
                    <DropdownToggle Color="Color.Secondary">
                        @context?.User?.Identity?.Name
                    </DropdownToggle>
                    <DropdownMenu>
                        <DropdownItem Clicked="@BeginSignOut">
                            Sign Out
                        </DropdownItem>
                    </DropdownMenu>
                </Dropdown>
            </Authorized>
            <NotAuthorized>
                <Button Color="Color.Secondary" Clicked="@(e => Navigation.NavigateTo("authentication/login"))" class="btn btn-sm">
                    Sign In
                </Button>
            </NotAuthorized>
        </AuthorizeView>
    </div>
</div>

@code {
    private async Task BeginSignOut()
    {
        await SignOutManager.SetSignOutState();
        Navigation.NavigateTo("authentication/logout");
    }
}